[2023-09-12 04:45:25,619] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: CallPostgreOperator.get_data scheduled__2023-09-11T01:00:00+00:00 [queued]>
[2023-09-12 04:45:25,629] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: CallPostgreOperator.get_data scheduled__2023-09-11T01:00:00+00:00 [queued]>
[2023-09-12 04:45:25,629] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2023-09-12 04:45:25,629] {taskinstance.py:1377} INFO - Starting attempt 1 of 1
[2023-09-12 04:45:25,629] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2023-09-12 04:45:25,645] {taskinstance.py:1397} INFO - Executing <Task(PythonOperator): get_data> on 2023-09-11 01:00:00+00:00
[2023-09-12 04:45:25,648] {standard_task_runner.py:52} INFO - Started process 693 to run task
[2023-09-12 04:45:25,651] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'CallPostgreOperator', 'get_data', 'scheduled__2023-09-11T01:00:00+00:00', '--job-id', '953', '--raw', '--subdir', 'DAGS_FOLDER/CallPostgreOperator.py', '--cfg-path', '/tmp/tmp1pjhqdeg', '--error-file', '/tmp/tmppgpphfg9']
[2023-09-12 04:45:25,652] {standard_task_runner.py:80} INFO - Job 953: Subtask get_data
[2023-09-12 04:45:25,713] {task_command.py:371} INFO - Running <TaskInstance: CallPostgreOperator.get_data scheduled__2023-09-11T01:00:00+00:00 [running]> on host b18943745c0d
[2023-09-12 04:45:25,746] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:202: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2023-09-12 04:45:25,782] {taskinstance.py:1591} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=CallPostgreOperator
AIRFLOW_CTX_TASK_ID=get_data
AIRFLOW_CTX_EXECUTION_DATE=2023-09-11T01:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-09-11T01:00:00+00:00
[2023-09-12 04:45:45,806] {local_task_job.py:221} WARNING - State of this instance has been externally set to restarting. Terminating instance.
[2023-09-12 04:45:45,808] {process_utils.py:129} INFO - Sending Signals.SIGTERM to group 693. PIDs of all processes in the group: [693]
[2023-09-12 04:45:45,808] {process_utils.py:80} INFO - Sending the signal Signals.SIGTERM to group 693
[2023-09-12 04:45:45,809] {taskinstance.py:1561} ERROR - Received SIGTERM. Terminating subprocesses.
[2023-09-12 04:45:45,822] {taskinstance.py:1909} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/CallPostgreOperator.py", line 27, in _get_data
    request.urlretrieve(url, output_path)
  File "/usr/local/lib/python3.7/urllib/request.py", line 276, in urlretrieve
    block = fp.read(bs)
  File "/usr/local/lib/python3.7/http/client.py", line 465, in read
    n = self.readinto(b)
  File "/usr/local/lib/python3.7/http/client.py", line 509, in readinto
    n = self.fp.readinto(b)
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/usr/local/lib/python3.7/ssl.py", line 1071, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/local/lib/python3.7/ssl.py", line 929, in read
    return self._sslobj.read(len, buffer)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1563, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2023-09-12 04:45:45,829] {taskinstance.py:1420} INFO - Marking task as UP_FOR_RETRY. dag_id=CallPostgreOperator, task_id=get_data, execution_date=20230911T010000, start_date=20230912T044525, end_date=20230912T044545
[2023-09-12 04:45:45,840] {standard_task_runner.py:97} ERROR - Failed to execute job 953 for task get_data (Task received SIGTERM signal; 693)
[2023-09-12 04:45:45,861] {process_utils.py:75} INFO - Process psutil.Process(pid=693, status='terminated', exitcode=1, started='04:45:25') (693) terminated with exit code 1
